!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("beauty-form",["jquery"],t):e.beautyForm=t(e.jQuery)}(this,function(e){"use strict";function t(e){this.node=e}function o(){try{var e=document.activeElement,t=e.contentDocument;return t&&t.activeElement||e}catch(o){}}function n(e){p.find("input[type=radio][name="+e.name+"]").each(function(){var t=i.get(this);t&&e!==this&&t.refresh()})}function i(o){var n=this;n.destroyed=!1,n.element=e(o),n.type=o.type,n.__observer=new t(o),n.type=n.type?n.type.toLowerCase():undefined;var r=i.get(o);if(r)return r;if("checkbox"!==n.type&&"radio"!==n.type)throw new TypeError("The element must be a checkbox or radio.");n.__init()}function r(e,t){function o(e,o,n,i){return!1===t||n<=e+i&&e<=o+i?Math.min(n,Math.max(o,e)):(o+n)/2}function n(e,t,o,i){return{left:e,top:t,width:o,height:i,right:e+o,bottom:t+i,translate:function(r,s){return n(r+e,s+t,o,i)},relativeFromTo:function(s,c){var l=e,u=t;if(s=s.offsetParent,c=c.offsetParent,s===c)return r;for(;s;s=s.offsetParent)l+=s.offsetLeft+s.clientLeft,u+=s.offsetTop+s.clientTop;for(;c;c=c.offsetParent)l-=c.offsetLeft+c.clientLeft,u-=c.offsetTop+c.clientTop;return n(l,u,o,i)}}}if(!e)throw new Error("Element is required in scrollIntoViewIfNeeded");if(m)return e.scrollIntoViewIfNeeded(t);for(var i,r=n(e.offsetLeft,e.offsetTop,e.offsetWidth,e.offsetHeight);(i=e.parentNode)!==document;){var s=i.offsetLeft+i.clientLeft,c=i.offsetTop+i.clientTop;r=r.relativeFromTo(e,i).translate(-s,-c);var l=o(i.scrollLeft,r.right-i.clientWidth,r.left,i.clientWidth),u=o(i.scrollTop,r.bottom-i.clientHeight,r.top,i.clientHeight);i.scrollLeft=l,i.scrollTop=u,r=r.translate(s-i.scrollLeft,c-i.scrollTop),e=i}}function s(t,o){var n=[].slice.call(arguments,2),i=o.apply(t,n);if("string"===e.type(i))return i;throw new TypeError("Render function must return a string.")}function c(t,o){var n=this;if(n.type="select",n.opened=!1,n.destroyed=!1,n.element=e(t),t.multiple||t.size>1)return n;o=e.extend({title:function(e,t){return'<i class="ui-beauty-select-align-middle"></i><span class="ui-beauty-select-title" title="'+t+'">'+t+'</span><i class="ui-beauty-select-icon"></i>'},dropdown:function(e,t){return'<dl class="ui-beauty-select-dropdown-items">'+t+"</dl>"},optgroup:function(e,t){return'<dt class="ui-beauty-select-optgroup" title="'+t+'">'+t+"</dt>"},option:function(e,t){return'<dd role="option" class="ui-beauty-select-option'+(t.group?" ui-beauty-select-optgroup-option":"")+(t.className?" "+t.className:"")+'" '+t.indexAttr+'="'+t.index+'" title="'+t.text+'">'+t.text+"</dd>"},dropdownWidth:null,optionIndexAttr:"data-option",optionSelectedClass:"ui-beauty-select-option-selected",optionDisabledClass:"ui-beauty-select-option-disabled"},o),e.each(["title","dropdown","optgroup","option"],function(t,n){if("function"!==e.type(o[n]))throw new TypeError("Options."+n+" must be a function.")}),n.options=o,n.__init()}function l(e){return function(t,o){var n=arguments;return n.length>1&&(o=[].slice.call(n,1)),o=o||[],this.each(function(n,i){var r=e.get(i);r||(r=new e(i,t)),r[t]&&r[t].apply(r,o)})}}e=e&&e.hasOwnProperty("default")?e["default"]:e;var u=Object.defineProperty,d=Object.getPrototypeOf,a=Object.getOwnPropertyDescriptor,f=d?function(e,t){return a(d(e),t)||a(Element.prototype,t)||a(HTMLElement.prototype,t)}:function(e,t){var o=a(e.constructor.prototype,t);return o&&o.set?o:a(Element.prototype,t)};t.prototype={watch:function(e,t){var o=this.node,n=f(o,e);return u(o,e,{configurable:!0,enumerable:n.enumerable,set:function(i){var r=o[e];return r!==i&&setTimeout(function(){t.call(o,r,i)},0),n.set.call(o,i)},get:function(){return n.get.call(o)}}),this},unwatch:function(e){return delete this.node[e],this}};var h=e(window),p=e(document),b={};i.get=function(t){return(t=e(t)).data("beauty-choice")},i.prototype={__init:function(){var e=this,t=e.type;if(!b[t]){b[t]=0;var o=".beauty-"+t,r="input[type="+t+"]";function s(){var e=i.get(this);e&&("radio"===t&&n(this),setTimeout(function(){e.refresh()}))}e.__observer.watch("checked",s),e.__observer.watch("disabled",s),e.__observer.watch("indeterminate",s),p.on("change"+o,r,s),p.on("focusin"+o,r,s),p.on("focusout"+o,r,s)}return e.__beauty()},__beauty:function(){var e=this,t=e.element;if(!i.get(t)){var o=e.type;t.wrap('<i tabindex="-1" class="ui-beauty-choice ui-beauty-'+o+'"/>'),b[o]++,e.choice=t.parent(),e.choice.attr("role",e.choice.type),t.data("beauty-choice",e)}return e.refresh()},refresh:function(){var e=this,t=e.element[0],n=t.indeterminate;return e.choice.toggleClass("ui-beauty-choice-disabled",t.disabled).toggleClass("ui-beauty-choice-indeterminate",n).toggleClass("ui-beauty-choice-focus",o()===t).toggleClass("ui-beauty-choice-checked",!n&&t.checked),e},destroy:function(){var e=this;if(!e.destroyed){var t=e.type,o=e.element;if(o.unwrap(),o.removeData("beauty-choice"),b[t]--,!b[t]){var n=".beauty-"+t;p.off("change"+n),p.off("focusin"+n),p.off("focusout"+n)}e.__observer.unwatch("checked"),e.__observer.unwatch("disabled"),e.__observer.unwatch("indeterminate"),e.destroyed=!0}}};var y,m=document.documentElement.scrollIntoViewIfNeeded,v=0,w=null,_={width:h.width(),height:h.height()};return c.get=function(t){return(t=e(t)).data("beauty-select")},c.prototype={__init:function(){var t=this,o=t.type,n=t.options,i=".beauty-"+o;if(w=t,!v){p.on("change"+i,"select",function(){var e=c.get(this);e&&(e.__renderTitlebox(),e.opened&&e.__refreshSelected())}),p.on("focusin"+i+" focusout"+i,"select",function(){var e=c.get(this);e&&e.__refreshSelectbox()}),p.on("mousedown"+i,function(t){var o=t.target,n=w.selectbox[0];o!==n&&!e.contains(n,o)&&w.opened&&(w.close(),w.__refreshSelectbox())}),p.on("keydown"+i,function(e){9!==e.which&&27!==e.which||(w.opened&&w.close(),w.__refreshSelectbox())}),h.on("resize"+i,function(){clearTimeout(y),_.width=h.width(),_.height=h.height(),y=setTimeout(function(){w.opened&&w.__position()},0)})}return t.__beauty(),t.element.on("keypress"+i,function(e){13===e.which&&(e.preventDefault(),t.opened?t.close():t.open())}),t.selectbox.on("mousedown"+i,function(o){if(!t.element[0].disabled)if(o.preventDefault(),t.focus(),t.opened){var n=o.target,i=t.dropdown[0];i===n||e.contains(i,n)||t.close()}else t.open()}),t.selectbox.on("click"+i,"["+n.optionIndexAttr+"]",function(o){o.preventDefault();var i=e(this);i.hasClass(n.optionDisabledClass)||(t.select(i.attr(n.optionIndexAttr)),t.close())}),t},__sizeSelectbox:function(){var e=this,t=e.element,o=e.selectbox,n=t.outerWidth()-o.outerWidth()+o.width(),i=t.outerHeight()-o.outerHeight()+o.height();return o.width(n),o.height(i),e},__sizeDropdown:function(){var e=this;e.opened||(e.dropdown.css("visibility","hidden"),e.dropdown.appendTo(e.selectbox));var t=e.dropdown,o=e.element.clone(),n={dropdown:{width:t.width(),outerWidth:t.outerWidth()}};o.css({position:"absolute",visibility:"hidden",width:"auto",top:"-100%",left:"-100%"}),o.insertBefore(e.element);var i=o.outerWidth();return o.remove(),i=Math.max(i,e.element.outerWidth())-n.dropdown.outerWidth+n.dropdown.width,i=Math.max(i,e.options.dropdownWidth||0),t.width(i),e.opened||(e.dropdown.detach(),e.dropdown.css("visibility","visible")),e},__position:function(){var e=this;if(e.opened){var t=e.selectbox,o=e.dropdown,n=t[0].getBoundingClientRect(),i={window:{height:h.height()},selectbox:{outerHeight:t.outerHeight()},dropdown:{outerHeight:o.outerHeight()}},r=n.top>h.height()-n.bottom?"top":"bottom";o.removeClass("ui-beauty-select-dropdown-"+("top"===r?"bottom":"top")).addClass("ui-beauty-select-dropdown-"+r),o.css({top:"bottom"===r?i.selectbox.outerHeight:-i.dropdown.outerHeight})}return e},__renderTitlebox:function(){var t=this,o=t.element[0],n=e(o.options[o.selectedIndex]);return t.titlebox.html(s(t,t.options.title,n,n.html())),t},__renderDropdown:function(){function t(e,t){var o=n===l,u={group:t,index:n++,text:e.html(),indexAttr:c.optionIndexAttr,className:e[0].disabled?c.optionDisabledClass:o?c.optionSelectedClass:""};i+=s(r,c.option,e,u)}function o(e){i+=s(r,c.optgroup,e,e.attr("label"))}var n=0,i="",r=this,c=r.options,l=r.element[0].selectedIndex,u=r.element.children();return u.each(function(){var n=e(this);switch(this.nodeName.toLowerCase()){case"option":t(n);break;case"optgroup":o(n),n.children().each(function(){t(e(this),n)})}}),r.dropdown.html(s(r,c.dropdown,u,i)),r},__refreshSelectbox:function(){var t=this,n=t.element[0],i=t.selectbox,r=o();return r=t.opened||r===n||r===i[0]||e.contains(i[0],r),i.toggleClass("ui-beauty-select-disabled",n.disabled).toggleClass("ui-beauty-select-focus",r),t},__refreshSelected:function(){var e=this,t=e.options,o=e.dropdown,n=t.optionSelectedClass,i=e.element[0].selectedIndex;o.find("."+n).removeClass(n);var s=o.find("["+t.optionIndexAttr+"="+i+"]");return s.addClass(n),r(s[0]),e},__beauty:function(){var t=this,o=t.element;if(!c.get(o)){o.addClass("ui-beauty-select-hidden");var n=e('<div role="combobox" tabindex="-1" class="ui-beauty-select"/>');t.titlebox=e('<div class="ui-beauty-select-titlebox"/>'),t.dropdown=e('<div role="listbox" class="ui-beauty-select-dropdown"/>'),n.append(t.titlebox).insertAfter(t.element),t.selectbox=n,v++,o.data("beauty-select",t)}return t.refresh()},focus:function(){return this.element.trigger("focus"),this},blur:function(){return this.element.trigger("blur"),this},enable:function(){return this.element[0].disabled=!1,this.__refreshSelectbox()},disable:function(){return this.element[0].disabled=!0,this.__refreshSelectbox()},refresh:function(){var e=this;return e.__sizeSelectbox(),e.__renderTitlebox(),e.__renderDropdown(),e.__sizeDropdown(),e.__refreshSelectbox()},select:function(e){var t=this,o=t.element[0],n=o.selectedIndex;return e>>>=0,o.selectedIndex=e,n!==e&&t.element.trigger("change"),this.__renderTitlebox()},open:function(){var e=this;return e.opened?e:(e.opened=!0,w!==e&&(w.opened&&w.close(),w.__refreshSelectbox()),w=e,e.selectbox.addClass("ui-beauty-select-opened"),e.dropdown.appendTo(e.selectbox),e.__position(),e.__refreshSelected(),e)},close:function(){var e=this;return e.opened&&(e.opened=!1,e.dropdown.detach(),e.selectbox.removeClass("ui-beauty-select-opened")),e},destroy:function(){var e=this;if(!e.destroyed){var t=e.type,o=e.element,n=".beauty-"+t;e.selectbox.off(),e.element.off("keypress"+n),e.selectbox.remove(),e.dropdown.remove(),o.removeData("beauty-select"),o.removeClass("ui-beauty-select-hidden"),--v||(p.off("change"+n),p.off("focusin"+n),p.off("focusout"+n),p.off("mousedown"+n),p.off("keydown"+n),h.off("resize"+n)),e.destroyed=!0}}},e.fn.checkbox=l(i),e.fn.radiobox=l(i),e.fn.selectbox=l(c),{Checkbox:i,RadioBox:i,SelectBox:c}});
//# sourceMappingURL=beauty-form.js.map