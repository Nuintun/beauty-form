!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("beauty-form",["jquery"],t):e.beautyForm=t(e.jQuery)}(this,function(e){"use strict";function t(e){this.node=e}function o(){try{var e=document.activeElement,t=e.contentDocument;return t&&t.activeElement||e}catch(o){}}function n(e){b.find("input[type=radio][name="+e.name+"]").each(function(){var t=r.get(this);t&&e!==this&&t.refresh()})}function r(o){var n=this;n.destroyed=!1,n.element=e(o),n.type=o.type,n.observer=new t(o),n.type=n.type?n.type.toLowerCase():undefined;var i=r.get(o);if(i)return i;if("checkbox"!==n.type&&"radio"!==n.type)throw new TypeError("The element must be a checkbox or radio.");n.__init()}function i(e,t){function o(e,o,n,r){return!1===t||n<=e+r&&e<=o+r?Math.min(n,Math.max(o,e)):(o+n)/2}function n(e,t,o,r){return{left:e,top:t,width:o,height:r,right:e+o,bottom:t+r,translate:function(i,s){return n(i+e,s+t,o,r)},relativeFromTo:function(s,c){var a=e,d=t;if(s=s.offsetParent,c=c.offsetParent,s===c)return i;for(;s;s=s.offsetParent)a+=s.offsetLeft+s.clientLeft,d+=s.offsetTop+s.clientTop;for(;c;c=c.offsetParent)a-=c.offsetLeft+c.clientLeft,d-=c.offsetTop+c.clientTop;return n(a,d,o,r)}}}if(!e)throw new Error("Element is required in scrollIntoViewIfNeeded");if(v)return e.scrollIntoViewIfNeeded(t);for(var r,i=n(e.offsetLeft,e.offsetTop,e.offsetWidth,e.offsetHeight);(r=e.parentNode)!==document;){var s=r.offsetLeft+r.clientLeft,c=r.offsetTop+r.clientTop;i=i.relativeFromTo(e,r).translate(-s,-c);var a=o(r.scrollLeft,i.right-r.clientWidth,i.left,r.clientWidth),d=o(r.scrollTop,i.bottom-r.clientHeight,i.top,r.clientHeight);r.scrollLeft=a,r.scrollTop=d,i=i.translate(s-r.scrollLeft,c-r.scrollTop),e=r}}function s(t,o){var n=[].slice.call(arguments,2),r=o.apply(t,n);if("string"===e.type(r))return r;throw new TypeError("Render function must return a string.")}function c(o,n){var r=this;if(r.type="select",r.opened=!1,r.destroyed=!1,r.element=e(o),r.observer=new t(o),o.multiple||o.size>1)return r;n=e.extend({title:function(e,t){return'<i class="ui-beauty-select-align-middle"></i><span class="ui-beauty-select-title" title="'+t+'">'+t+'</span><i class="ui-beauty-select-icon"></i>'},dropdown:function(e,t){return'<dl class="ui-beauty-select-dropdown-items">'+t+"</dl>"},optgroup:function(e,t){return'<dt class="ui-beauty-select-optgroup" title="'+t+'">'+t+"</dt>"},option:function(e,t){return'<dd role="option" class="ui-beauty-select-option'+(t.group?" ui-beauty-select-optgroup-option":"")+(t.className?" "+t.className:"")+'" '+t.indexAttr+'="'+t.index+'" title="'+t.text+'">'+t.text+"</dd>"},dropdownWidth:null,optionIndexAttr:"data-option",optionSelectedClass:"ui-beauty-select-option-selected",optionDisabledClass:"ui-beauty-select-option-disabled"},n),e.each(["title","dropdown","optgroup","option"],function(t,o){if("function"!==e.type(n[o]))throw new TypeError("Options."+o+" must be a function.")}),r.options=n,r.__init()}function a(e){return function(t,o){if("api"===t)return e.get(this[0]);var n=arguments;return n.length>1&&(o=[].slice.call(n,1)),o=o||[],this.each(function(n,r){var i=e.get(r);i||(i=new e(r,t)),i[t]&&i[t].apply(i,o)})}}e=e&&e.hasOwnProperty("default")?e["default"]:e;var d=Object.defineProperty,l=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,f=Object.getOwnPropertyDescriptor,p=l?function(e,t){return f(l(e),t)||f(Element.prototype,t)||f(HTMLElement.prototype,t)||f(Node.prototype,t)}:function(e,t){var o=Element.prototype;return u.call(o,t)||(o=e.constructor.prototype),f(o,t)};window.getNodeDescriptor=p,t.prototype={watch:function(e,t){var o=this.node,n=p(o,e);if(!n.hasOwnProperty("value")){var r={configurable:!0,enumerable:n.enumerable};n.set&&(r.set=function(r){var i=o[e];return i!==r&&(n.set.call(o,r),t.call(o,i,r)),r}),n.get&&(r.get=function(){return n.get.call(o)}),d(o,e,r)}return this},unwatch:function(e){return delete this.node[e],this}};var h=e(window),b=e(document),y=0;r.get=function(t){return(t=e(t)).data("beauty-choice")},r.prototype={__init:function(){function e(){var e=r.get(this);e&&("radio"===o&&n(this),e.refresh())}var t=this,o=t.type;if(t.observer.watch("checked",e),t.observer.watch("disabled",e),t.observer.watch("indeterminate",e),!y){var i=".beauty-"+o,s="input[type="+o+"]";b.on("change"+i,s,e),b.on("focusin"+i,s,e),b.on("focusout"+i,s,e)}return t.__beauty()},__beauty:function(){var e=this,t=e.element;if(!r.get(t)){var o=e.type;t.wrap('<i tabindex="-1" class="ui-beauty-choice ui-beauty-'+o+'"/>'),e.choice=t.parent(),e.choice.attr("role",e.choice.type),t.data("beauty-choice",e),y++}return e.refresh()},refresh:function(){var e=this,t=e.element[0],n=t.indeterminate;return e.choice.toggleClass("ui-beauty-choice-disabled",t.disabled).toggleClass("ui-beauty-choice-indeterminate",n).toggleClass("ui-beauty-choice-focus",o()===t).toggleClass("ui-beauty-choice-checked",!n&&t.checked),e},destroy:function(){var e=this;if(!e.destroyed){var t=e.type,o=e.element;if(o.unwrap(),o.removeData("beauty-choice"),e.observer.unwatch("checked"),e.observer.unwatch("disabled"),e.observer.unwatch("indeterminate"),!--y){var n=".beauty-"+t;b.off("change"+n),b.off("focusin"+n),b.off("focusout"+n)}e.destroyed=!0}}};var w,v=document.documentElement.scrollIntoViewIfNeeded,m=0,g=null,x={width:h.width(),height:h.height()};return c.get=function(t){return(t=e(t)).data("beauty-select")},c.prototype={__init:function(){function t(){var e=c.get(this);e&&(e.__renderTitlebox(),e.opened&&e.__refreshSelected())}function o(){var e=c.get(this);e&&e.__refreshSelectbox()}var n=this,r=n.type,i=n.options,s=".beauty-"+r;if(g=n,n.observer.watch("disabled",o),n.observer.watch("selectedIndex",t),!m){b.on("change"+s,"select",t),b.on("focusin"+s+" focusout"+s,"select",o),b.on("mousedown"+s,function(t){var o=t.target,n=g.selectbox[0];o!==n&&!e.contains(n,o)&&g.opened&&(g.close(),g.__refreshSelectbox())}),b.on("keydown"+s,function(e){9!==e.which&&27!==e.which||(g.opened&&g.close(),g.__refreshSelectbox())}),h.on("resize"+s,function(){clearTimeout(w),x.width=h.width(),x.height=h.height(),w=setTimeout(function(){g.opened&&g.__position()},0)})}return n.__beauty(),n.element.on("keypress"+s,function(e){13===e.which&&(e.preventDefault(),n.opened?n.close():n.open())}),n.selectbox.on("mousedown"+s,function(t){t.preventDefault();var o=n.element;if(!o[0].disabled){if(n.opened){var r=t.target,i=n.dropdown[0];i===r||e.contains(i,r)||n.close()}else n.open();setTimeout(function(){o.focus()},0)}}),n.selectbox.on("click"+s,"["+i.optionIndexAttr+"]",function(t){t.preventDefault();var o=e(this);o.hasClass(i.optionDisabledClass)||(n.element[0].selectedIndex=o.attr(i.optionIndexAttr),n.close())}),n},__sizeSelectbox:function(){var e=this,t=e.element,o=e.selectbox,n=t.outerWidth()-o.outerWidth()+o.width(),r=t.outerHeight()-o.outerHeight()+o.height();return o.width(n),o.height(r),e},__sizeDropdown:function(){var e=this;e.opened||(e.dropdown.css("visibility","hidden"),e.dropdown.appendTo(e.selectbox));var t=e.dropdown,o=e.element.clone(),n={dropdown:{width:t.width(),outerWidth:t.outerWidth()}};o.css({position:"absolute",visibility:"hidden",width:"auto",top:"-100%",left:"-100%"}),o.insertBefore(e.element);var r=o.outerWidth();return o.remove(),r=Math.max(r,e.element.outerWidth())-n.dropdown.outerWidth+n.dropdown.width,r=Math.max(r,e.options.dropdownWidth||0),t.width(r),e.opened||(e.dropdown.detach(),e.dropdown.css("visibility","visible")),e},__position:function(){var e=this;if(e.opened){var t=e.selectbox,o=e.dropdown,n=t[0].getBoundingClientRect(),r={window:{height:h.height()},selectbox:{outerHeight:t.outerHeight()},dropdown:{outerHeight:o.outerHeight()}},i=n.top>h.height()-n.bottom?"top":"bottom";o.removeClass("ui-beauty-select-dropdown-"+("top"===i?"bottom":"top")).addClass("ui-beauty-select-dropdown-"+i),o.css({top:"bottom"===i?r.selectbox.outerHeight:-r.dropdown.outerHeight})}return e},__renderTitlebox:function(){var e="",t=this,o=null,n=t.element[0],r=t.options.title,i=n.selectedIndex;return i>=0&&(e=(o=n.options[i]).innerHTML),t.titlebox.html(s(t,r,o,e)),t},__renderDropdown:function(){function t(e,t){var o=n===a,d={group:t,index:n++,text:e.html(),indexAttr:c.optionIndexAttr,className:e[0].disabled?c.optionDisabledClass:o?c.optionSelectedClass:""};r+=s(i,c.option,e,d)}function o(e){r+=s(i,c.optgroup,e,e.attr("label"))}var n=0,r="",i=this,c=i.options,a=i.element[0].selectedIndex,d=i.element.children();return d.each(function(){var n=e(this);switch(this.nodeName.toLowerCase()){case"option":t(n);break;case"optgroup":o(n),n.children().each(function(){t(e(this),n)})}}),i.dropdown.html(s(i,c.dropdown,d,r)),i},__refreshSelectbox:function(){var t=this,n=t.element[0],r=t.selectbox,i=o();return i=t.opened||i===n||i===r[0]||e.contains(r[0],i),r.toggleClass("ui-beauty-select-disabled",n.disabled).toggleClass("ui-beauty-select-focus",i),t},__refreshSelected:function(){var e=this,t=e.options,o=e.dropdown,n=t.optionSelectedClass,r=e.element[0].selectedIndex;o.find("."+n).removeClass(n);var s=o.find("["+t.optionIndexAttr+"="+r+"]");return s.addClass(n),i(s[0]),e},__beauty:function(){var t=this,o=t.element;if(!c.get(o)){o.addClass("ui-beauty-select-hidden");var n=e('<div role="combobox" tabindex="-1" class="ui-beauty-select"/>');t.titlebox=e('<div class="ui-beauty-select-titlebox"/>'),t.dropdown=e('<div role="listbox" class="ui-beauty-select-dropdown"/>'),n.append(t.titlebox).insertAfter(t.element),t.selectbox=n,o.data("beauty-select",t),m++}return t.refresh()},refresh:function(){var e=this;return e.__sizeSelectbox(),e.__renderTitlebox(),e.__renderDropdown(),e.__sizeDropdown(),e.__refreshSelectbox()},open:function(){var e=this;return e.opened?e:(e.opened=!0,g!==e&&(g.opened&&g.close(),g.__refreshSelectbox()),g=e,e.selectbox.addClass("ui-beauty-select-opened"),e.dropdown.appendTo(e.selectbox),e.__position(),e.__refreshSelected(),e)},close:function(){var e=this;return e.opened&&(e.opened=!1,e.dropdown.detach(),e.selectbox.removeClass("ui-beauty-select-opened")),e},destroy:function(){var e=this;if(!e.destroyed){var t=e.type,o=e.element,n=".beauty-"+t;e.selectbox.off(),e.element.off("keypress"+n),e.selectbox.remove(),e.dropdown.remove(),o.removeData("beauty-select"),o.removeClass("ui-beauty-select-hidden"),e.observer.watch("disabled",refresh),e.observer.watch("selectedIndex",refresh),--m||(b.off("change"+n),b.off("focusin"+n),b.off("focusout"+n),b.off("mousedown"+n),b.off("keydown"+n),h.off("resize"+n)),e.destroyed=!0}}},e.fn.checkbox=a(r),e.fn.radiobox=a(r),e.fn.selectbox=a(c),{Checkbox:r,RadioBox:r,SelectBox:c}});
//# sourceMappingURL=beauty-form.js.map