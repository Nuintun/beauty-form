!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("beauty-form",["jquery"],t):e.beautyForm=t(e.jQuery)}(this,function(e){"use strict";function t(){try{var e=document.activeElement,t=e.contentDocument;return t&&t.activeElement||e}catch(o){}}function o(e){this.node=e}function n(e){a.find("input[type=radio][name="+e.name+"]").each(function(){var t=r.get(this);t&&e!==this&&t.refresh()})}function r(t){var n=this;n.destroyed=!1,n.element=e(t),n.type=t.type,n.__observer=new o(t),n.type=n.type?n.type.toLowerCase():undefined;var i=r.get(t);if(i)return i;if("checkbox"!==n.type&&"radio"!==n.type)throw new TypeError("The element must be a checkbox or radio.");n.__init()}function i(e,t){function o(e,o,n,r){return!1===t||n<=e+r&&e<=o+r?Math.min(n,Math.max(o,e)):(o+n)/2}function n(e,t,o,r){return{left:e,top:t,width:o,height:r,right:e+o,bottom:t+r,translate:function(i,s){return n(i+e,s+t,o,r)},relativeFromTo:function(s,c){var l=e,u=t;if(s=s.offsetParent,c=c.offsetParent,s===c)return i;for(;s;s=s.offsetParent)l+=s.offsetLeft+s.clientLeft,u+=s.offsetTop+s.clientTop;for(;c;c=c.offsetParent)l-=c.offsetLeft+c.clientLeft,u-=c.offsetTop+c.clientTop;return n(l,u,o,r)}}}if(!e)throw new Error("Element is required in scrollIntoViewIfNeeded");if(m)return e.scrollIntoViewIfNeeded(t);for(var r,i=n(e.offsetLeft,e.offsetTop,e.offsetWidth,e.offsetHeight);(r=e.parentNode)!==document;){var s=r.offsetLeft+r.clientLeft,c=r.offsetTop+r.clientTop;i=i.relativeFromTo(e,r).translate(-s,-c);var l=o(r.scrollLeft,i.right-r.clientWidth,i.left,r.clientWidth),u=o(r.scrollTop,i.bottom-r.clientHeight,i.top,r.clientHeight);r.scrollLeft=l,r.scrollTop=u,i=i.translate(s-r.scrollLeft,c-r.scrollTop),e=r}}function s(t,o){var n=[].slice.call(arguments,2),r=o.apply(t,n);if("string"===e.type(r))return r;throw new TypeError("Render function must return a string.")}function c(t,o){var n=this;if(n.type="select",n.opened=!1,n.destroyed=!1,n.element=e(t),t.multiple||t.size>1)return n;o=e.extend({title:function(e,t){return'<i class="ui-beauty-select-align-middle"></i><span class="ui-beauty-select-title" title="'+t+'">'+t+'</span><i class="ui-beauty-select-icon"></i>'},dropdown:function(e,t){return'<dl class="ui-beauty-select-dropdown-items">'+t+"</dl>"},optgroup:function(e,t){return'<dt class="ui-beauty-select-optgroup" title="'+t+'">'+t+"</dt>"},option:function(e,t){return'<dd role="option" class="ui-beauty-select-option'+(t.group?" ui-beauty-select-optgroup-option":"")+(t.className?" "+t.className:"")+'" '+t.indexAttr+'="'+t.index+'" title="'+t.text+'">'+t.text+"</dd>"},dropdownWidth:null,optionIndexAttr:"data-option",optionSelectedClass:"ui-beauty-select-option-selected",optionDisabledClass:"ui-beauty-select-option-disabled"},o),e.each(["title","dropdown","optgroup","option"],function(t,n){if("function"!==e.type(o[n]))throw new TypeError("Options."+n+" must be a function.")}),n.options=o,n.__init()}function l(e){return function(t,o){if("api"===t)return e.get(this[0]);var n=arguments;return n.length>1&&(o=[].slice.call(n,1)),o=o||[],this.each(function(n,r){var i=e.get(r);i||(i=new e(r,t)),i[t]&&i[t].apply(i,o)})}}var u=(e=e&&e.hasOwnProperty("default")?e["default"]:e)(window),a=e(document),d=(Object.prototype.toString,Object.defineProperty),f=Object.getPrototypeOf,h=Object.getOwnPropertyDescriptor,p=f?function(e,t){return h(f(e),t)||h(Element.prototype,t)||h(HTMLElement.prototype,t)||h(Node.prototype,t)}:function(e,t){var o=h(e.constructor.prototype,t);return o&&o.set?o:h(Element.prototype,t)};o.prototype={watch:function(e,t){var o=this.node,n=p(o,e),r={configurable:!0,enumerable:n.enumerable};if(n.hasOwnProperty("value")){return r.writable=!!n.writable,console.log(e,n.writable,typeof n.value),this}else n.set&&(r.set=function(r){var i=o[e];return i!==r&&(n.set.call(o,r),t.call(o,i,r)),r}),n.get&&(r.get=function(){return n.get.call(o)});return d(o,e,r),this},unwatch:function(e){return delete this.node[e],this}};var b={};r.get=function(t){return(t=e(t)).data("beauty-choice")},r.prototype={__init:function(){var e=this,t=e.type;if(!b[t]){b[t]=0;var o=".beauty-"+t,i="input[type="+t+"]";function s(){var e=r.get(this);e&&("radio"===t&&n(this),setTimeout(function(){e.refresh()}))}e.__observer.watch("checked",s),e.__observer.watch("disabled",s),e.__observer.watch("setAttribute",s),e.__observer.watch("removeAttribute",s),e.__observer.watch("indeterminate",s),a.on("change"+o,i,s),a.on("focusin"+o,i,s),a.on("focusout"+o,i,s)}return e.__beauty()},__beauty:function(){var e=this,t=e.element;if(!r.get(t)){var o=e.type;t.wrap('<i tabindex="-1" class="ui-beauty-choice ui-beauty-'+o+'"/>'),b[o]++,e.choice=t.parent(),e.choice.attr("role",e.choice.type),t.data("beauty-choice",e)}return e.refresh()},refresh:function(){var e=this,o=e.element[0],n=o.indeterminate;return e.choice.toggleClass("ui-beauty-choice-disabled",o.disabled).toggleClass("ui-beauty-choice-indeterminate",n).toggleClass("ui-beauty-choice-focus",t()===o).toggleClass("ui-beauty-choice-checked",!n&&o.checked),e},destroy:function(){var e=this;if(!e.destroyed){var t=e.type,o=e.element;if(o.unwrap(),o.removeData("beauty-choice"),b[t]--,!b[t]){var n=".beauty-"+t;a.off("change"+n),a.off("focusin"+n),a.off("focusout"+n)}e.__observer.unwatch("checked"),e.__observer.unwatch("disabled"),e.__observer.unwatch("setAttribute"),e.__observer.unwatch("removeAttribute"),e.__observer.unwatch("indeterminate"),e.destroyed=!0}}};var y,m=document.documentElement.scrollIntoViewIfNeeded,v=0,w=null,_={width:u.width(),height:u.height()};return c.get=function(t){return(t=e(t)).data("beauty-select")},c.prototype={__init:function(){var t=this,o=t.type,n=t.options,r=".beauty-"+o;if(w=t,!v){a.on("change"+r,"select",function(){var e=c.get(this);e&&(e.__renderTitlebox(),e.opened&&e.__refreshSelected())}),a.on("focusin"+r+" focusout"+r,"select",function(){var e=c.get(this);e&&e.__refreshSelectbox()}),a.on("mousedown"+r,function(t){var o=t.target,n=w.selectbox[0];o!==n&&!e.contains(n,o)&&w.opened&&(w.close(),w.__refreshSelectbox())}),a.on("keydown"+r,function(e){9!==e.which&&27!==e.which||(w.opened&&w.close(),w.__refreshSelectbox())}),u.on("resize"+r,function(){clearTimeout(y),_.width=u.width(),_.height=u.height(),y=setTimeout(function(){w.opened&&w.__position()},0)})}return t.__beauty(),t.element.on("keypress"+r,function(e){13===e.which&&(e.preventDefault(),t.opened?t.close():t.open())}),t.selectbox.on("mousedown"+r,function(o){if(!t.element[0].disabled)if(o.preventDefault(),t.focus(),t.opened){var n=o.target,r=t.dropdown[0];r===n||e.contains(r,n)||t.close()}else t.open()}),t.selectbox.on("click"+r,"["+n.optionIndexAttr+"]",function(o){o.preventDefault();var r=e(this);r.hasClass(n.optionDisabledClass)||(t.select(r.attr(n.optionIndexAttr)),t.close())}),t},__sizeSelectbox:function(){var e=this,t=e.element,o=e.selectbox,n=t.outerWidth()-o.outerWidth()+o.width(),r=t.outerHeight()-o.outerHeight()+o.height();return o.width(n),o.height(r),e},__sizeDropdown:function(){var e=this;e.opened||(e.dropdown.css("visibility","hidden"),e.dropdown.appendTo(e.selectbox));var t=e.dropdown,o=e.element.clone(),n={dropdown:{width:t.width(),outerWidth:t.outerWidth()}};o.css({position:"absolute",visibility:"hidden",width:"auto",top:"-100%",left:"-100%"}),o.insertBefore(e.element);var r=o.outerWidth();return o.remove(),r=Math.max(r,e.element.outerWidth())-n.dropdown.outerWidth+n.dropdown.width,r=Math.max(r,e.options.dropdownWidth||0),t.width(r),e.opened||(e.dropdown.detach(),e.dropdown.css("visibility","visible")),e},__position:function(){var e=this;if(e.opened){var t=e.selectbox,o=e.dropdown,n=t[0].getBoundingClientRect(),r={window:{height:u.height()},selectbox:{outerHeight:t.outerHeight()},dropdown:{outerHeight:o.outerHeight()}},i=n.top>u.height()-n.bottom?"top":"bottom";o.removeClass("ui-beauty-select-dropdown-"+("top"===i?"bottom":"top")).addClass("ui-beauty-select-dropdown-"+i),o.css({top:"bottom"===i?r.selectbox.outerHeight:-r.dropdown.outerHeight})}return e},__renderTitlebox:function(){var t=this,o=t.element[0],n=e(o.options[o.selectedIndex]);return t.titlebox.html(s(t,t.options.title,n,n.html())),t},__renderDropdown:function(){function t(e,t){var o=n===l,u={group:t,index:n++,text:e.html(),indexAttr:c.optionIndexAttr,className:e[0].disabled?c.optionDisabledClass:o?c.optionSelectedClass:""};r+=s(i,c.option,e,u)}function o(e){r+=s(i,c.optgroup,e,e.attr("label"))}var n=0,r="",i=this,c=i.options,l=i.element[0].selectedIndex,u=i.element.children();return u.each(function(){var n=e(this);switch(this.nodeName.toLowerCase()){case"option":t(n);break;case"optgroup":o(n),n.children().each(function(){t(e(this),n)})}}),i.dropdown.html(s(i,c.dropdown,u,r)),i},__refreshSelectbox:function(){var o=this,n=o.element[0],r=o.selectbox,i=t();return i=o.opened||i===n||i===r[0]||e.contains(r[0],i),r.toggleClass("ui-beauty-select-disabled",n.disabled).toggleClass("ui-beauty-select-focus",i),o},__refreshSelected:function(){var e=this,t=e.options,o=e.dropdown,n=t.optionSelectedClass,r=e.element[0].selectedIndex;o.find("."+n).removeClass(n);var s=o.find("["+t.optionIndexAttr+"="+r+"]");return s.addClass(n),i(s[0]),e},__beauty:function(){var t=this,o=t.element;if(!c.get(o)){o.addClass("ui-beauty-select-hidden");var n=e('<div role="combobox" tabindex="-1" class="ui-beauty-select"/>');t.titlebox=e('<div class="ui-beauty-select-titlebox"/>'),t.dropdown=e('<div role="listbox" class="ui-beauty-select-dropdown"/>'),n.append(t.titlebox).insertAfter(t.element),t.selectbox=n,v++,o.data("beauty-select",t)}return t.refresh()},focus:function(){return this.element.trigger("focus"),this},blur:function(){return this.element.trigger("blur"),this},enable:function(){return this.element[0].disabled=!1,this.__refreshSelectbox()},disable:function(){return this.element[0].disabled=!0,this.__refreshSelectbox()},refresh:function(){var e=this;return e.__sizeSelectbox(),e.__renderTitlebox(),e.__renderDropdown(),e.__sizeDropdown(),e.__refreshSelectbox()},select:function(e){var t=this,o=t.element[0],n=o.selectedIndex;return e>>>=0,o.selectedIndex=e,n!==e&&t.element.trigger("change"),this.__renderTitlebox()},open:function(){var e=this;return e.opened?e:(e.opened=!0,w!==e&&(w.opened&&w.close(),w.__refreshSelectbox()),w=e,e.selectbox.addClass("ui-beauty-select-opened"),e.dropdown.appendTo(e.selectbox),e.__position(),e.__refreshSelected(),e)},close:function(){var e=this;return e.opened&&(e.opened=!1,e.dropdown.detach(),e.selectbox.removeClass("ui-beauty-select-opened")),e},destroy:function(){var e=this;if(!e.destroyed){var t=e.type,o=e.element,n=".beauty-"+t;e.selectbox.off(),e.element.off("keypress"+n),e.selectbox.remove(),e.dropdown.remove(),o.removeData("beauty-select"),o.removeClass("ui-beauty-select-hidden"),--v||(a.off("change"+n),a.off("focusin"+n),a.off("focusout"+n),a.off("mousedown"+n),a.off("keydown"+n),u.off("resize"+n)),e.destroyed=!0}}},e.fn.checkbox=l(r),e.fn.radiobox=l(r),e.fn.selectbox=l(c),{Checkbox:r,RadioBox:r,SelectBox:c}});
//# sourceMappingURL=beauty-form.js.map